[
    {
        "diksha_tpd_district_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.district_id=sde.district_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_block_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.block_id=sde.block_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_cluster_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.cluster_id=sde.cluster_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_school_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/Nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.school_id=sde.school_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.school_id,a.school_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_r2_district_overall": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,a.district_id,a.district_name, '0' as collection_id, 'all' as collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all' as collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg  group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment  group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name;"
    },
    {
        "diksha_tpd_r2_district_last_90_days": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '90 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,a.district_id,a.district_name, '0' as collection_id, 'all' as collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '90 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all' as collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '90 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name;"
    },
    {
        "diksha_tpd_r2_district_last_30_days": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '30 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,a.district_id,a.district_name, '0' as collection_id, 'all' as collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '30 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all_program_collections' as collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '30 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name;"
    },
    {
        "diksha_tpd_r2_district_last_7_days": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '7 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,a.district_id,a.district_name, '0' as collection_id, 'all' as collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '7 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all_program_collections' as collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '7 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name;"
    },
    {
        "diksha_tpd_r2_district_last_day": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '1 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '1 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,a.district_id,a.district_name, '0' as collection_id, 'all' as collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '1 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '1 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all_program_collections' as collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '1 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where batch_end_date is not null and   ((batch_end_date - batch_start_date) < (select now()::DATE - (now() -INTERVAL '1 DAY')::DATE )) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name;"
    },
    {
        "diksha_tpd_r2_block_last_day": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name;"
    },
    {
        "diksha_tpd_r2_block_last_7_days": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_block_last_30_days": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_block_overall": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg  group by block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_cluster_last_day": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name "
    },
    {
        "diksha_tpd_r2_cluster_last_7_days": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'Cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_cluster_last_30_days": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_cluster_overall": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name "
    },
    {
        "diksha_tpd_r2_school_last_day": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school 'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name "
    },
    {
        "diksha_tpd_r2_school_last_7_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_school_last_30_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_school_overall": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg  group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name; "
    },
    {
        "diksha_tpd_r2_raw_last_day": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school 'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_last_7_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_last_30_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_overall": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_enrolment_progress_all_program": "select res.program_id,res.program_name,res.dates as date,sum(res.day_wise) over (partition by res.program_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.program_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.program_id,a.program_name,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled from (select program_id,program_name,collection_id,district,collection_name,district_id,batch_id,generate_series(batch_start_date::date,batch_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as a join (select distinct batch_id,collection_id,district_id,program_id,expected_enrollment,(batch_end_date::date - batch_start_date::date)+1 as duration,expected_enrollment/COALESCE((batch_end_date::date - batch_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as b  on  a.batch_id = b.batch_id and a.collection_id=b.collection_id and a.district_id=b.district_id and a.program_id=b.program_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.program_id,a.dates,a.program_name) as res group by res.program_id,res.dates,res.day_wise,total_enrolled,program_name;"
    },
    {
        "diksha_tpd_enrolment_progress_all_prog_coll": "select res.program_id,res.program_name,res.collection_id,collection_name,res.dates as date,sum(res.day_wise) over (partition by res.collection_id,res.program_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.collection_id,res.program_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.program_id,a.program_name,a.collection_id,a.collection_name,a.dates,sum(day_wise) as day_wise,coalesce(sum(total_enrolled),0) as total_enrolled from (select program_id,program_name,collection_id,collection_name,district_id,district,batch_id,generate_series(batch_start_date::date,batch_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as a join (select distinct batch_id,collection_id,district_id,expected_enrollment,(batch_end_date::date - batch_start_date::date)+1 as duration,expected_enrollment/COALESCE((batch_end_date::date - batch_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment where batch_end_date is not null ) as b  on  a.batch_id = b.batch_id and a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.collection_id,a.dates,collection_name,a.program_id,a.program_name) as res group by res.collection_id,res.dates,res.day_wise,total_enrolled,collection_name,program_id,program_name;"
    },
    {
        "diksha_tpd_enrolment_progress_all_coll_dist": "select res.program_id,res.program_name,res.collection_id,collection_name,res.district_id,district as district_name,res.dates as date,sum(res.day_wise) over (partition by res.district_id,res.collection_id,res.program_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.district_id,res.collection_id,res.program_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.program_id,a.program_name,a.collection_id,a.collection_name,a.district_id,a.district,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled,enrolled_date from (select program_id,program_name,collection_id,collection_name,district_id,district,batch_id,generate_series(batch_start_date::date,batch_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as a join (select distinct batch_id,collection_id,district_id,expected_enrollment,(batch_end_date::date - batch_start_date::date)+1 as duration,expected_enrollment/COALESCE((batch_end_date::date - batch_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment where batch_end_date is not null ) as b  on  a.batch_id = b.batch_id and a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.collection_id,a.district_id,a.dates,enrolled_date,collection_name,a.district,a.program_id,a.program_name) as res group by res.collection_id,res.district_id,res.dates,res.day_wise,total_enrolled,collection_name,district_name,program_id,program_name;"
    },
    {
        "diksha_tpd_enrolment_progress_district": "select res.district_id,district as district_name,res.dates as date,sum(res.day_wise) over (partition by res.district_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.district_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.district_id,a.district,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled from (select collection_id,district,collection_name,district_id,batch_id,generate_series(batch_start_date::date,batch_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as a join (select distinct batch_id,collection_id,district_id,expected_enrollment,(batch_end_date::date - batch_start_date::date)+1 as duration,expected_enrollment/COALESCE((batch_end_date::date - batch_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as b  on  a.batch_id = b.batch_id and a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.district_id,a.dates,a.district) as res group by res.district_id,res.dates,res.day_wise,total_enrolled,district_name;"
    },
    {
        "diksha_tpd_enrolment_progress_all_course": "select res.collection_id,res.collection_name,res.dates as date,sum(res.day_wise) over (partition by res.collection_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.collection_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.collection_id,a.collection_name,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled from (select collection_id,district,collection_name,district_id,batch_id,generate_series(batch_start_date::date,batch_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as a join (select distinct batch_id,collection_id,district_id,expected_enrollment,(batch_end_date::date - batch_start_date::date)+1 as duration,expected_enrollment/COALESCE((batch_end_date::date - batch_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as b  on  a.batch_id = b.batch_id and a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.collection_id,a.dates,a.collection_name) as res group by collection_id,res.dates,res.day_wise,total_enrolled,collection_name;"
    },
    {
        "diksha_tpd_enrolment_progress_state": "select res.dates as date,sum(res.day_wise) over (order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled from (select collection_id,district,collection_name,district_id,batch_id,generate_series(batch_start_date::date,batch_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as a join (select distinct batch_id,collection_id,district_id,expected_enrollment,(batch_end_date::date - batch_start_date::date)+1 as duration,expected_enrollment/COALESCE((batch_end_date::date - batch_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment  where batch_end_date is not null ) as b  on  a.batch_id = b.batch_id and a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.dates) as res group by res.dates,res.day_wise,total_enrolled;"
    }
]