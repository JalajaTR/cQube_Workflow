[
	{
		"diksha_table_txtb_last_day": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='TextBook'and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_txtb_last_7_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_txtb_last_30_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_txtb_all": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content_year_month where collection_type='TextBook' group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content_year_month where collection_type='TextBook' group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_txtb_meta": "select json_build_object('timeRange',timeRange,'districtDetails',array_to_json(array_agg(row_to_json(b)))) from (select case when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '30 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days','last_30_days'] when (select exists(select 1 from diksha_total_content where content_view_date between (select max(content_view_date)-INTERVAL '7 DAY' from diksha_total_content) and (select max(content_view_date) from diksha_total_content)))=True then array['last_day','last_7_days'] when (select exists(select 1 from diksha_total_content where content_view_date = (select max(content_view_date) from diksha_total_content)))=True then array['last_day'] end as timeRange,cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name,timeRange )as a join (select cast(district_id as text) as district_id,district_name from diksha_total_content where district_name is not null and district_id is not null group by district_id,district_name ) as b on a.district_id=b.district_id group by timeRange"
	},
	{
		"diksha_table_crs_last_day": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_crs_last_7_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_crs_last_30_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_crs_all": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content_year_month where collection_type='Course' group by district_id,district_name,content_name,collection_name,content_subject,object_id,content_medium) union (select 'All' as district_id,'' as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content_year_month where collection_type='Course' group by content_name,collection_name,content_subject,content_medium,object_id)"
	},
	{
		"diksha_table_all_last_day": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,content_name,collection_name,content_subject,collection_type,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by content_name,collection_name,content_subject,content_medium,collection_type,object_id)"
	},
	{
		"diksha_table_all_last_7_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,collection_type,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,collection_type,content_medium,object_id)"
	},
	{
		"diksha_table_all_last_30_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,collection_type,content_subject,object_id,content_medium) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by content_name,collection_name,content_subject,collection_type,content_medium,object_id)"
	},
	{
		"diksha_table_all_all": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content_year_month group by district_id,district_name,content_name,collection_type,collection_name,content_subject,content_medium,object_id) union (select 'All' as  district_id,'' as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_medium as Medium from diksha_total_content_year_month group by content_name,collection_name,collection_type,content_subject,content_medium,object_id)"
	},
	{
		"diksha_barc_txtb_last_day": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from(select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name  order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by collection_name)as a"
	},
	{
		"diksha_barc_txtb_last_7_days": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
	},
	{
		"diksha_barc_txtb_last_30_days": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
	},
	{
		"diksha_barc_txtb_all": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) in ('textbook','textbookunit') and district_name is not null and district_id is not null group by collection_name)as a"
	},
	{
		"diksha_barc_crs_last_day": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by collection_name)as a"
	},
	{
		"diksha_barc_crs_last_7_days": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
	},
	{
		"diksha_barc_crs_last_30_days": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
	},
	{
		"diksha_barc_crs_all": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content_year_month where collection_type is not null and lower(collection_type) ='course'and district_name is not null and district_id is not null group by district_id,district_name,collection_name, collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content_year_month where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null group by district_id,district_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content_year_month where collection_type is not null and lower(collection_type) ='course' and district_name is not null and district_id is not null group by collection_name)as a"
	},
	{
		"diksha_barc_all_last_day": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,collection_name,collection_type order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by collection_name)as a;"
	},
	{
		"diksha_barc_all_last_7_days": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,'all_collections' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'all_districts' as type,'All' as collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,'collection_footer' as type,collection_name,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
	},
	{
		"diksha_barc_all_last_30_days": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select district_id,district_name,collection_name,'all_collections' as type,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'All' as collection_name,'all_districts' as type,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from  (select 1 as district_id,'' as district_name,collection_name,'collection_footer' as type,sum(total_count) as Total_content_plays from diksha_total_content where collection_type is not null and district_name is not null and district_id is not null and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by collection_name)as a"
	},
	{
		"diksha_barc_all_all": "select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over(partition by a.collection_name)),0)),2) as percentage from (select  district_id,district_name,collection_name,'all_collections' as type,sum(total_count) as Total_content_plays from diksha_total_content_year_month where collection_type is not null and district_name is not null and district_id is not null group by district_id,district_name,collection_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select district_id,district_name,'All' as collection_name,'all_districts' as type,sum(total_count) as Total_content_plays from diksha_total_content_year_month where collection_type is not null and district_name is not null and district_id is not null group by district_id,district_name order by 1,3)as a union select a.*,round((coalesce(a.Total_content_plays,0)*100.0/coalesce((sum(a.Total_content_plays) over()),0)),2) as percentage from (select 1 as district_id,'' as district_name,collection_name,'collection_footer' as type,sum(total_count) as Total_content_plays from diksha_total_content_year_month where collection_type is not null and district_name is not null and district_id is not null group by collection_name) as a"
	},
	{
		"diksha_table_raw_txtb_last_day": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_txtb_last_7_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_txtb_last_30_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='TextBook' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_txtb_all": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Textbook,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content_year_month where collection_type='TextBook' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_crs_last_day": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_crs_last_7_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_crs_last_30_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where collection_type='Course' and content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_crs_all": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_name as Course,content_name as Content_Name,sum(total_count) as Total_content_plays ,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content_year_month where collection_type='Course' group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_all_last_day": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,content_name,collection_name,content_subject,content_gradelevel,collection_type,object_id,content_medium)"
	},
	{
		"diksha_table_raw_all_last_7_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,content_subject,collection_type,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_all_last_30_days": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content where content_view_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,content_name,collection_name,collection_type,content_subject,content_gradelevel,object_id,content_medium)"
	},
	{
		"diksha_table_raw_all_all": "(select cast(district_id as text)as district_id,initcap(district_name)as district_name,collection_type,collection_name,content_name as Content_Name,sum(total_count) as Total_content_plays,object_id as content_id,content_subject as Subject,content_gradelevel as Grade,content_medium as Medium from diksha_total_content group by district_id,district_name,content_name,collection_type,collection_name,content_subject,content_gradelevel,content_medium,object_id)"
	},
	{
		"diksha_map_etb_state": "select *,round(cast(total_time_spent / total_content_plays as decimal),2) as avg_time_spent from(select district_id,district_name,district_latitude,district_longitude,sum(total_count) as total_content_plays,round(cast(sum(total_time_spent) as decimal),2) as total_time_spent from diksha_total_content where collection_type in('TextBook','TextBookUnit') group by district_id,district_name,district_latitude,district_longitude) as res;"
	},
	{
		"diksha_map_tpd_state": "select *,round(cast(total_time_spent / total_content_plays as decimal),2) as avg_time_spent from(select district_id,district_name,district_latitude,district_longitude,sum(total_count) as total_content_plays,round(cast(sum(total_time_spent) as decimal),2) as total_time_spent from diksha_total_content where collection_type='Course' group by district_id,district_name,district_latitude,district_longitude) as res;"
	},
	{
		"diksha_line_etb_state": "select concat(month,'_',year) as month,plays from (select substring(cast(year as text),3,4)  as year,TO_CHAR(TO_DATE (month::text, 'MM'), 'Mon') AS month,sum(total_count) as plays from diksha_total_content_year_month where collection_type in('TextBook','TextBookUnit') group by year,month) as res ;"
	},
	{
		"diksha_pie_etb_meta_district": "select distinct district_id,district_name from diksha_total_content;"
	},
	{
		"diksha_pie_etb_state": "select object_type,round(sum(total_count)*100.0/(select sum(total_count) as total_count from diksha_total_content where lower(dimensions_pdata_id) in ('prod.diksha.portal','prod.diksha.app','prod.diksha.desktop') and lower(collection_type) !='unknown'),2) as total_content_plays_percent from diksha_total_content dct where lower(dimensions_pdata_id) in ('prod.diksha.portal','prod.diksha.app','prod.diksha.desktop') and lower(collection_type) !='unknown' and object_type is not NULL group by object_type;"
	},
	{
		"diksha_pie_etb_district": "select district_id,district_name,object_type,round(sum(total_count)*100.0/(select sum(total_count) as total_count from diksha_total_content where lower(dimensions_pdata_id) in ('prod.diksha.portal','prod.diksha.app','prod.diksha.desktop') and lower(collection_type) !='unknown'),2) as total_content_plays_percent from diksha_total_content dct where lower(dimensions_pdata_id) in ('prod.diksha.portal','prod.diksha.app','prod.diksha.desktop') and lower(collection_type) !='unknown' and object_type is not NULL group by object_type,district_name,district_id;"
	},
	{
		"diksha_hbar_crs_district": "select district_id,district_name,collection_name, round(cast((sum(total_time_spent) / sum(total_count)) as decimal ),2)as avg_time_spent from diksha_total_content where collection_type in('Course') group by district_id,district_name,collection_name"
	},
	{
		"diksha_hbar_crs_state": "select collection_name, round(cast((sum(total_time_spent) / sum(total_count)) as decimal ),2)as avg_time_spent from diksha_total_content where collection_type in('Course') group by collection_name"
	}
]